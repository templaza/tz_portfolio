!function(a,b){"use strict";function c(a,b,c){return c&&"auto"!=c||!a.last().attr("data-order")||!a.last().data("order").toString().length||(c="filter_asc"),a.sort(function(a,b){var d=jQuery(a).data("order")?parseInt(jQuery(a).data("order"),10):jQuery(a).text().trim(),e=jQuery(b).data("order")?parseInt(jQuery(b).data("order"),10):jQuery(b).text().trim();if("*"!=jQuery(a).attr("data-option-value")&&"*"!=jQuery(b).attr("data-option-value")){if("asc"==c.substr(c.length-3,c.length).toLowerCase())return e>d?-1:d>e?1:0;if("desc"==c.substr(c.length-4,c.length).toLowerCase())return d>e?-1:e>d?1:0}}),a.each(function(a,c){b.append(c).append("\n")}),!0}function d(a,c,d,e){if(a.length&&a.find(".name a").length){var f="index.php?option=com_tz_portfolio_plus&task=portfolio.ajaxcomments",g=[],h=[];e&&(f=e),a.map(function(a,b){jQuery(b).find(".name a").length&&jQuery(b).find(".name a").attr("href").length&&(g.push(jQuery(b).find(".name a").attr("href")),jQuery(b).attr("id")&&h.push(jQuery(b).attr("id")))}),jQuery.ajax({type:"post",url:f,data:{Itemid:c,url:b.Base64.encode(b.JSON.encode(g)),id:b.Base64.encode(b.JSON.encode(h))}}).success(function(a){if(a&&a.length){var c=b.JSON.decode(a);"object"==typeof c&&jQuery.each(c,function(a,b){jQuery("#"+a).find(".TzPortfolioCommentCount").length&&jQuery("#"+a).find(".TzPortfolioCommentCount").html(d+"<span>"+b+"</span>")})}})}}a.tzPortfolioPlusIsotope=function(d,e){var f=a(d),g=a.extend(!0,a.tzPortfolioPlusIsotope.defaults,e);g.params.orderby_sec.length||(g.params.orderby_sec="rdate");var h=g.params,i=g.isotope_options;switch(h.orderby_sec){default:i.core.sortBy="original-order",i.core.sortAscending=!0;break;case"date":i.core.sortBy="date",i.core.sortAscending=!0,g.timeline&&(i.core.sortAscending=!1);break;case"rdate":i.core.sortBy="date",i.core.sortAscending=!1;break;case"alpha":i.core.sortBy="name",i.core.sortAscending=!0;break;case"ralpha":i.core.sortBy="name",i.core.sortAscending=!1;break;case"author":i.core.sortBy="date",i.core.sortAscending=!1;break;case"rauthor":i.core.sortBy="date",i.core.sortAscending=!1;break;case"hits":i.core.sortBy="hits",i.core.sortAscending=!1;break;case"rhits":i.core.sortBy="hits",i.core.sortAscending=!0}return e.isotope_options&&e.isotope_options.core&&"undefined"!=e.isotope_options.core.sortAscending&&(i.core.sortAscending=e.isotope_options.core.sortAscending),i.core.layoutMode.length||(h.layout_type.length?i.core.layoutMode=h.layout_type[0]:i.core.layoutMode="masonry"),f.tz_init=function(b){var d=a(g.mainElementSelector).width(),e=h.tz_column_width,j=0,k=0,l=0,m=0,n=0;d<f.width()&&(d=f.width()),g.columnWidth&&(e=g.columnWidth),g.timeline&&a.extend(!0,a.Isotope.prototype,{_sort:function(){var b=this.options.sortBy,c=this._getSorter,d=this.options.sortAscending?1:-1,e=function(e,f){var g=c(e,b),h=c(f,b);if(g===h&&"original-order"!==b&&(g=c(e,"original-order"),h=c(f,"original-order")),"name"==b||"hits"==b){if(a(e).attr("data-category")>a(f).attr("data-category"))return 0;if(a(e).attr("data-category")==a(f).attr("data-category"))return a(e).hasClass("TzDate")?0:g>h?1*d:0}return(g>h?1:h>g?-1:0)*d};this.$filteredAtoms.sort(e)}}),j=Math.floor(d/e),g.beforeCalculateColumn(j),k=j+1,l=k-d/e>d/e-j?j:k,m=d,n=d,l>1&&(m=Math.floor(d/l),n=2*m),g.afterCalculateColumn(l,m),f.find(".element").width(m),f.find(g.elementFeatureSelector).width(n),f.find(".element").find(".element.TzDate").width(d),g.afterColumnWidth(l,m),b&&f.find(".element").css({opacity:0}),f.imagesLoaded(function(){g.afterImagesLoaded(),b&&f.find(".element").css({opacity:1}),f.isotope({resizable:!1,itemSelector:i.core.itemSelector,layoutMode:i.core.layoutMode,sortBy:i.core.sortBy,sortAscending:i.core.sortAscending,filter:i.core.filter,masonry:{columnWidth:m},getSortData:i.core.getSortData},function(){parseInt(h.tz_show_filter,10)&&h.filter_tags_categories_order&&"undefined"!=typeof c&&c(a(i.sortParentTag).find(i.sortChildTag),a(i.sortParentTag),h.filter_tags_categories_order),i.complete()})})},f.loadPortfolio=function(){var c=a(i.filterSelector),d=c.find(i.tagFilter),e=null,g=i.core;d.click(function(c){c.preventDefault();var d=a(this);if(d.hasClass("selected"))return!1;var i=d.parents(".option-set");i.find(".selected").removeClass("selected"),d.addClass("selected");var j=g,k=i.attr("data-option-key"),l=d.attr("data-option-value");return l="false"===l?!1:l,j[k]=l,"layoutMode"===k&&"function"==typeof b.changeLayoutMode?b.changeLayoutMode(d,j):("name"==l&&("alpha"==h.orderby_sec||"alpha"!=h.orderby_sec&&"ralpha"!=h.orderby_sec?j.sortAscending=!0:"ralpha"==h.orderby_sec&&(j.sortAscending=!1)),"date"==l&&("rdate"==h.orderby_sec||"date"!=h.orderby_sec&&"rdate"!=h.orderby_sec?j.sortAscending=!1:"date"==h.orderby_sec&&(j.sortAscending=!0)),"hits"==l&&("hits"==h.orderby_sec||"hits"!=h.orderby_sec&&"rhits"!=h.orderby_sec?j.sortAscending=!1:"rhits"==h.orderby_sec&&(j.sortAscending=!0)),j=a.extend(e,j),f.isotope(j),e=j),!1})},f.tz_init(!0),a(i.filterSelector+"[data-option-key=sortBy]").children().removeClass("selected").end().find("[data-option-value="+i.core.sortBy+"]").addClass("selected"),f.loadPortfolio(),f.vars=g,a.data(d,"tzPortfolioPlusIsotope",f),a(b).smartresize(function(){f.tz_init()}),this},a.tzPortfolioPlusIsotope.defaults={columnWidth:"",mainElementSelector:"#TzContent",containerElementSelector:"#portfolio",elementFeatureSelector:".tz_feature_item",JSON:{},timeline:!1,params:{orderby_sec:"rdate",tz_show_filter:1,filter_tags_categories_order:"auto",tz_portfolio_plus_layout:"ajaxButton",comment_function_type:"default",tz_filter_type:"categories",show_all_filter:0,tz_comment_type:"disqus",tz_show_count_comment:1,tz_column_width:233,layout_type:["masonry"]},isotope_options:{core:{itemSelector:".element",layoutMode:"",sortBy:"date",sortAscending:!1,filter:"*",getSortData:{date:function(a){var b=a.hasClass("element")&&a.attr("data-date").length?a.attr("data-date"):a.find(".create").text();return parseInt(b,10)},hits:function(a){var b=a.hasClass("element")&&a.attr("data-hits").length?a.attr("data-hits"):a.find(".hits").text();return parseInt(b,10)},name:function(a){var b=a.hasClass("element")&&a.find(".TzPortfolioTitle.name").length?a.find(".TzPortfolioTitle.name").text().trim():a.attr("data-title").length?a.attr("data-title"):"",c=b.length?b:a.text().trim();return c}}},filterSelector:"#tz_options .option-set",tagFilter:"a",sortParentTag:"#filter",sortChildTag:"a",complete:function(){}},beforeCalculateColumn:function(){},afterCalculateColumn:function(){},afterColumnWidth:function(){},afterImagesLoaded:function(){}},a.fn.tzPortfolioPlusIsotope=function(b){return void 0===b&&(b={}),"object"==typeof b?this.each(function(){new a.tzPortfolioPlusIsotope(this,b)}):void 0},a.tzPortfolioPlusInfiniteScroll=function(e,f){function g(){var c=[];return a(j.sortParentTag+" "+j.sortChildTag).each(function(){c.push(a(this).attr("data-option-value").replace(".",""))}),b.JSON.encode(c)}function h(){var c=[];return a(j.sortParentTag+" "+j.sortChildTag).each(function(){c.push(a(this).attr("data-option-value").replace(".category",""))}),b.JSON.encode(c)}var i=a(e),j=a.extend(!0,a.tzPortfolioPlusInfiniteScroll.defaults,f),k=j.params,l=1,m=!0,n=a("div.TzDate:last").attr("data-category");i.infinitescroll({navSelector:j.navSelector,nextSelector:j.nextSelector,itemSelector:j.itemSelector,dataType:j.dataType,errorCallback:function(){j.errorCallback||(k.tz_portfolio_plus_layout&&"ajaxButton"!=k.tz_portfolio_plus_layout||a("#tz_append a").unbind("click").html(j.loadedText).show(),"ajaxInfiScroll"==k.tz_portfolio_plus_layout&&a("#tz_append").removeAttr("style").html('<a class="tzNomore">'+j.loadedText+"</a>"),a("#tz_append a").addClass("tzNomore"),a("#infscr-loading").css("display","none"))},loading:{msgText:j.msgText,finishedMsg:"",img:"",selector:"#tz_append"}},function(b){a("#infscr-loading").css("display","none");var e=a(b).css({opacity:0});"js"==k.comment_function_type&&parseInt(k.tz_show_count_comment,10)&&("facebook"==k.tz_comment_type||"disqus"==k.tz_comment_type)&&"undefined"!=typeof d&&d(e,j.itemID,j.commentText),e.imagesLoaded(function(){e.animate({opacity:1});var b=i.data("tzPortfolioPlusIsotope");if(b.tz_init(),j.timeline?(b.isotope("insert",e),e.each(function(){var c=a(this).attr("class");if(c.match(/.*?TzDate.*?/i)){var d=a(this).attr("data-category");n==d?(a(this).remove(),b.isotope("reloadItems")):n=d}})):b.isotope("appended",e),l++,parseInt(k.tz_show_filter,10)){var d="";j.lang&&j.lang.length&&(d="&lang="+j.lang),parseInt(k.show_all_filter,10)||("tags"==k.tz_filter_type&&a.ajax({url:"index.php?option=com_tz_portfolio_plus&task=portfolio.ajaxtags"+d,data:{tags:g(),Itemid:j.itemID,page:l}}).success(function(d){if(d.length){var e=a(d);a(j.sortParentTag).append(e),b.loadPortfolio(),k.filter_tags_categories_order&&"undefined"!=typeof c&&c(a(j.sortParentTag).find(j.sortChildTag),a(j.sortParentTag),k.filter_tags_categories_order)}m=!0}),"categories"==k.tz_filter_type&&a.ajax({url:"?option=com_tz_portfolio_plus&task=portfolio.ajaxcategories"+d,data:{catIds:h(),Itemid:j.itemID,page:l}}).success(function(d){if(d.length){var e=a(d);a(j.sortParentTag).append(e),b.loadPortfolio(),k.filter_tags_categories_order&&"undefined"!=typeof c&&c(a(j.sortParentTag).find(j.sortChildTag),a(j.sortParentTag),k.filter_tags_categories_order)}m=!0}))}else m=!0;e.length&&a("div#tz_append").find("a:first").show()})}),"ajaxInfiScroll"==k.tz_portfolio_plus_layout&&a(b).scroll(function(){a(b).unbind(".infscr"),m&&a(b).scrollTop()>=i.height()-30&&(m=!1,i.infinitescroll("retrieve"))}),k.tz_portfolio_plus_layout&&"ajaxButton"!=k.tz_portfolio_plus_layout||(a(b).unbind(".infscr"),a("div#tz_append a").click(function(){a(this).stop(),a("div#tz_append").find("a:first").hide(),i.infinitescroll("retrieve")}))},a.tzPortfolioPlusInfiniteScroll.defaults={rootPath:"",msgText:'<i class="tz-icon-spinner tz-spin"></i><em>Loading the next set of posts...</em>',loadedText:"No more pages to load",navSelector:"#loadaj a",nextSelector:"#loadaj a:first",itemSelector:".element",dataType:"html",Itemid:null,commentText:"Comment count:",timeline:!1,sortParentTag:"#filter",sortChildTag:"a",lang:"",errorCallback:null},a.fn.tzPortfolioPlusInfiniteScroll=function(b){return void 0===b&&(b={}),"object"==typeof b?this.each(function(){new a.tzPortfolioPlusInfiniteScroll(this,b)}):void 0}}(jQuery,window);